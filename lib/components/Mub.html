<div class="container">
  {{#if formatData.length > 0}}
    <Table config="{{config}}" data="{{formatData}}"/>
  {{/if}}
</div>

<style>
</style>

<script>
  import getRange from 'get-range';
  import flatten from 'lodash.flatten';
  import Table from './Table.html';

  export default {
    components: {
      Table
    },
    data() {
      return {
        _heights: [],
        config: {
          height: 'auto',
          width: '100%',
          padding: {
            top: 0,
            right: '10px',
            bottom: '10px',
            left: 0
          }
        },
        data: null,
        formatData: []
      }
    },
    oncreate() {
      this.observe('data', data => {
        if (data === null) {
          return;
        }

        if (!('rows' in data)) {
          return;
        }

        const state = this.get();

        for (const idx of getRange(data.rows.length)) {
          const col = (() => {
            const _col = [];
            if ('header' in data) {
              _col.push(data.header[idx])
            }

            _col.push(data.rows[idx]);

            if ('footer' in data) {
              _col.psh(data.footer[idx])
            }

            return flatten(_col);
          })();

          state.formatData.push(col);
        }

        this.set({formatData: state.formatData});
      });
    }
  }
</script>
